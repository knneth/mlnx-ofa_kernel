From: Valentine Fatiev <valentinef@nvidia.com>
Subject: [PATCH] BACKPORT: drivers/net/ethernet/mellanox/mlx5/core/ecpf.c

---
 drivers/net/ethernet/mellanox/mlx5/core/ecpf.c | 12 ++++++++++++
 1 file changed, 12 insertions(+)

--- a/drivers/net/ethernet/mellanox/mlx5/core/ecpf.c
+++ b/drivers/net/ethernet/mellanox/mlx5/core/ecpf.c
@@ -531,11 +531,17 @@ static struct attribute *smart_nic_attrs
 	NULL,
 };
 
+#ifdef HAVE_KOBJ_TYPE_DEFAULT_GROUPS
 ATTRIBUTE_GROUPS(smart_nic);
+#endif
 
 static struct kobj_type smart_nic_type = {
 	.sysfs_ops     = &kobj_sysfs_ops,
+#ifdef HAVE_KOBJ_TYPE_DEFAULT_GROUPS
 	.default_groups = smart_nic_groups
+#else
+	.default_attrs = smart_nic_attrs
+#endif
 };
 
 void mlx5_smartnic_sysfs_init(struct net_device *dev)
@@ -670,11 +676,17 @@ static struct attribute *regex_attrs[] =
 	NULL,
 };
 
+#ifdef HAVE_KOBJ_TYPE_DEFAULT_GROUPS
 ATTRIBUTE_GROUPS(regex);
+#endif
 
 static struct kobj_type regex_type = {
 	.sysfs_ops     = &kobj_sysfs_ops,
+#ifdef HAVE_KOBJ_TYPE_DEFAULT_GROUPS
 	.default_groups = regex_groups
+#else
+	.default_attrs = regex_attrs
+#endif
 };
 
 int mlx5_regex_sysfs_init(struct mlx5_core_dev *dev)
