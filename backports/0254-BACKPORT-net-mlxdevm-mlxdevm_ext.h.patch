From: Valentine Fatiev <valentinef@nvidia.com>
Subject: [PATCH] BACKPORT: include/net/mlxdevm.h

Change-Id: I7ee3bb447d661bad1c256dcf650cc5fd7d4e4e51
---
 include/net/mlxdevm.h | 18 ++++++++++++++++++
 1 file changed, 18 insertions(+)

--- a/include/net/mlxdevm.h
+++ b/include/net/mlxdevm.h
@@ -22,6 +22,9 @@
 #include <uapi/linux/mlxdevm.h>
 #include <linux/xarray.h>
 #include <linux/firmware.h>
+#ifdef HAVE_BASECODE_EXTRAS
+#include <linux/dcbnl.h>
+#endif
 
 #ifdef HAVE_BLOCKED_DEVLINK_CODE
 struct devlink;
@@ -524,6 +527,17 @@ struct mlxdevm_param_item {
 	bool driverinit_value_new_valid;
 };
 
+#ifndef HAVE_DEVLINK_HAS_RATE_FUNCTIONS
+struct mlxdevm_rate_node {
+	struct list_head list;
+	char *name;
+	u64 tx_max;
+	u64 tx_share;
+
+	u32 tc_bw[IEEE_8021QAZ_MAX_TCS];
+};
+#endif
+
 enum mlxdevm_param_generic_id {
 	MLXDEVM_PARAM_GENERIC_ID_INT_ERR_RESET,
 	MLXDEVM_PARAM_GENERIC_ID_MAX_MACS,
@@ -673,6 +687,9 @@ struct mlxdevm_flash_update_params {
 	const struct firmware *fw;
 	const char *component;
 	u32 overwrite_mask;
+#ifndef HAVE_FLASH_UPDATE_GET_3_PARAMS
+	const char* file_name;
+#endif
 };
 
 #define MLXDEVM_SUPPORT_FLASH_UPDATE_OVERWRITE_MASK	BIT(0)
@@ -1786,6 +1803,7 @@ void devlink_port_type_ib_set(struct dev
 void mlxdevm_port_type_clear(struct mlxdevm_port *mlxdevm_port);
 void mlxdevm_port_attrs_set(struct mlxdevm_port *mlxdevm_port,
 			    struct mlxdevm_port_attrs *mlxdevm_port_attrs);
+
 void mlxdevm_port_attrs_pci_pf_set(struct mlxdevm_port *mlxdevm_port, u32 controller,
 				   u16 pf, bool external);
 void mlxdevm_port_attrs_pci_vf_set(struct mlxdevm_port *mlxdevm_port, u32 controller,
